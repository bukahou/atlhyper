# ============================================
# AtlHyper 统一配置管理
# ============================================

apiVersion: v1
kind: Namespace
metadata:
  name: atlhyper
  labels:
    app.kubernetes.io/name: atlhyper

---
# ============================================
# ConfigMap - 非敏感配置
# ============================================
apiVersion: v1
kind: ConfigMap
metadata:
  name: atlhyper-config
  namespace: atlhyper
data:
  # === Controller 配置 ===
  MASTER_DB_PATH: "/app/data/master.db"

  # === Agent 配置 ===
  AGENT_CLUSTER_ID: "my-cluster"
  AGENT_MASTER_URL: "http://atlhyper-controller:8081"

  # === Web 配置 ===
  # Web 通过 middleware 代理 API 请求到 Controller
  API_URL: "http://atlhyper-controller:8080"

  # === Metrics 配置 ===
  METRICS_PROC_ROOT: "/hostproc"
  METRICS_SYS_ROOT: "/hostsys"
  METRICS_HOST_ROOT: "/host_root"
  METRICS_AGENT_ADDR: "http://atlhyper-agent-service:8082"

  # === 管理员配置（非敏感） ===
  DEFAULT_ADMIN_USERNAME: "admin"
  DEFAULT_ADMIN_DISPLAY_NAME: "Administrator"
  DEFAULT_ADMIN_EMAIL: "admin@atlhyper.com"

---
# ============================================
# Secret - 敏感信息
# ============================================
# !! 重要安全警告 !!
# 以下所有值都是占位符，必须在部署前修改为实际值
# 使用默认值部署会导致严重安全风险
# ============================================
apiVersion: v1
kind: Secret
metadata:
  name: atlhyper-secret
  namespace: atlhyper
type: Opaque
stringData:
  # === 管理员密码 ===
  # 必须修改！建议使用 16+ 字符的强密码
  DEFAULT_ADMIN_PASSWORD: "admin123"

  # === JWT 密钥 ===
  # 必须修改！建议使用 32+ 字符的随机字符串
  # 生成命令: openssl rand -base64 32
  JWT_SECRET: "CHANGE_THIS_RANDOM_JWT_SECRET_MIN_32_CHARS"
